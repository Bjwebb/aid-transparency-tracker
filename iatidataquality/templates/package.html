{% extends "layout.html" %}
{% block content %}
   <script src="/static/jquery.tablesorter.min.js"></script>
    <script >
    $(function() {
    $("table#packages").tablesorter({ sortList: [[0,0]] });
    $("table#publishers").tablesorter({ sortList: [[0,0]] });
    $("table#results").tablesorter({ sortList: [[0,0]] });
    });

    </script>
    {% if p[0] %}
    {% set grp = p[1] %}
    {% set pkg = p[0] %}
    {% else %}
    {% set pkg = p %}
    {% endif %}
	<h1>{{pkg.package_title}}<code>{{pkg.package_name}}</code></h1> 
    <table class="table" id="publishers">
    <tbody>
    <tr>
	<td>Package name</td><td>{{ pkg.package_name }}</td>
    </tr>
    <tr>
    <td>Package title</td><td>{{ pkg.package_title }}</td>
    </tr>
    <tr>
    <td>Package country</td><td>{{ pkg.package_country }}</td>
    </tr>
    {% if grp is defined %}
    <tr>
    <td>Package group</td><td><a href="{{url_for('publisher', id=grp.id)}}">{{ grp.name }}</a></td>
    </tr>
    {% endif %}
    <tr>
    <td>Link</td><td><a href="http://iatiregistry.org/dataset/{{pkg.package_name}}">http://iatiregistry.org/dataset/{{ pkg.package_name }}</a></td>
    </tr>
    </tbody>
    </table>

    <h1>Test runs</h1>
    <table class="table" id="publishers">
    <thead>
    <th>ID</th><th>Date</th>
    </thead>
    <tbody>
    {% for runtime in runtimes %}
    <tr>
	<td>{{runtime.runtime_id}}</td><td>{{ runtime.runtime_datetime }}</td>
    </tr>
    {% endfor %}
    </tbody>
    </table>

    <h1>Latest results <code>{{latest_runtime.runtime_datetime}}</code></h1>
    <table class="table" id="results">
    <thead>
    <th>Test</th><th>% Passed</th>
    </thead>
    <tbody>
    {% for result in results %}
    <tr>
	<td><a href="{{url_for('tests', id=result.id)}}">{{ result.name }}</a></td><td>{{result.percentage}}</td>
    </tr>
    {% endfor %}
    </tbody>
    </table>

{% endblock %}

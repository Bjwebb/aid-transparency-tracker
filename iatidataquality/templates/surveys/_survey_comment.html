{% from "surveys/ind_commitment_comment.html" 
        import ind_commitment as ind_commitment %}
{% from "surveys/ind_zero_comment.html" 
        import ind_zero as ind_zero %}
{% extends "surveys/survey_edit.html" %}
{% block survey %}

    <style type="text/css">
        th.restrict_text, td.restrict_text { 
            max-width:40px; 
            word-wrap:break-word;
        }
    </style>
	<h3>Please check the assessment for {{org_indicators.zero|count+org_indicators.commitment|count}} information items.</h3>
    <div class="alert alert-info">
        <h4>Guidelines</h4>
		{% if workflow.Workflow.name != 'cso' %}
		<!-- text if we're not a CSO reviewer: -->
        <p>Based on feedback from your organisation and our CSO partner, Publish What You Fund has reviewed responses to the survey. Some of our responses may have changed based on evidence provided by you or the CSO. This is our final assessment</p>
        <p>We welcome your feedback on this assessment.</p>
		{% else %}
		<!-- text if we're a CSO reviewer -->
		<p>Publish What You Fund has conducted an initial assessment of 67 donor organisations, reviewing their overall commitment to aid transparency and checking what information they publish on their activities. Thank you for agreeing to review the assessment for this organisation.</p>
		<p>Donor organisations were asked to provide feedback on our findings. Please let us know whether you agree or disagree with Publish What You Fund's assessment of the donor organisation. </p>
<p>In the comments box, please add any feedback or clarifications that you think will help us better understand your response. This is particularly helpful if you think the donor organisationâ€™s response might be unclear or open to interpretation. Feel free to add any questions you have for us in the same box.</p>
  		<p>A guide to reviewing this assessment can be found here.</p>
		{% endif %}
    </div>
    
    {% set rows = surveydata|count %}
    {% if not workflow.Workflow.name in surveydata %}
    {% set rows = rows+1 %}
    {% endif %}
    {% if (workflow.Workflow.name != 'cso') and ('cso' in surveydata) %}
    {% set rows = rows-1 %}
    {% endif %}
    {% if ('pwyffinal' in surveydata) %}
    {% set rows = rows-1 %}
    {% endif %}
    <form action="" method="post">
    <h2>Commitments?</h2>
    <table class="table" id="indicators">
    <thead><th>Information item</th><th>Responder</th><th>Score</th><th class="restrict_text">Evidence</th><th class="restrict_text">Comments</th></thead>
    <tbody>
    {% for i, indicator in org_indicators["commitment"].items() %}
	  {{ ind_commitment(surveydata, rows, workflow, indicator) }}
    {% endfor %}
    </tbody>
    </table>
    <hr />
    <h2>Publication</h2>
    <table class="table" id="indicators">

    <thead><th>Information item</th><th>Responder</th><th>Published?</th><th class="restrict_text">Evidence</th><th class="restrict_text">Comments</th></thead>

    <tbody>
    {% for i, indicator in org_indicators['zero'].items() %}
	 {{ ind_zero(surveydata, workflow, indicator) }}
    {% endfor %}
    </tbody>
    </table>
	<!-- boilerplate below this line -->
    {% if organisationsurvey.currentworkflow_id==none or organisationsurvey.currentworkflow_id==workflow.Workflow.id %}
    <label for="submit" class="muted"><input id="submit" type="submit" class="btn btn-success" value="Submit response" name="submit" /> Submit data (you cannot edit this survey once it's been submitted)</label>
    {%endif%}
    <label for="save" class="muted"><input id="save" type="submit" class="btn" value="Save" name="save" /> Save changes</label>

    </form>
{% endblock %}
